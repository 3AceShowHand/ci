FROM centos:8
COPY pd-server /pd-server
COPY pd-ctl /pd-ctl
COPY pd-recover /pd-recover
RUN set -e && \
    sed -e 's|^mirrorlist=|#mirrorlist=|g' \
         -e 's|^#baseurl=http://mirror.centos.org/$contentdir|baseurl=https://mirrors.tuna.tsinghua.edu.cn/centos|g' \
         -i.bak \
         /etc/yum.repos.d/CentOS-*.repo \
    dnf install bind-utils wget -y && \
    dnf clean all
EXPOSE 2379 2380
ENTRYPOINT ["/pd-server"]
